{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>居民点id</th>\n",
       "      <th>居民点location</th>\n",
       "      <th>设施点id</th>\n",
       "      <th>设施点location</th>\n",
       "      <th>duration_distance_bicycling</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>1</td>\n",
       "      <td>119.9242,32.49087</td>\n",
       "      <td>16982,70758</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>2</td>\n",
       "      <td>119.900891,32.459968</td>\n",
       "      <td>16380,68251</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>3</td>\n",
       "      <td>119.9201,32.500119</td>\n",
       "      <td>17363,72345</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>4</td>\n",
       "      <td>119.882343,32.324787</td>\n",
       "      <td>13113,54638</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>5</td>\n",
       "      <td>120.273972,32.021327</td>\n",
       "      <td>3712,15466</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>726175</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>61</td>\n",
       "      <td>121.007933,31.929588</td>\n",
       "      <td>14291,59545</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>726176</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>62</td>\n",
       "      <td>120.467338,32.542238</td>\n",
       "      <td>32377,134904</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>726177</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>63</td>\n",
       "      <td>121.66908,31.816983</td>\n",
       "      <td>10048,41869</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>726178</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>64</td>\n",
       "      <td>121.185719,32.351002</td>\n",
       "      <td>14223,59263</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>726179</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>65</td>\n",
       "      <td>120.556805,32.385662</td>\n",
       "      <td>27395,114148</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>726180 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        居民点id         居民点location  设施点id           设施点location  \\\n",
       "0           1  120.15568,31.97798      1     119.9242,32.49087   \n",
       "1           1  120.15568,31.97798      2  119.900891,32.459968   \n",
       "2           1  120.15568,31.97798      3    119.9201,32.500119   \n",
       "3           1  120.15568,31.97798      4  119.882343,32.324787   \n",
       "4           1  120.15568,31.97798      5  120.273972,32.021327   \n",
       "...       ...                 ...    ...                   ...   \n",
       "726175  11172  121.51107,32.05536     61  121.007933,31.929588   \n",
       "726176  11172  121.51107,32.05536     62  120.467338,32.542238   \n",
       "726177  11172  121.51107,32.05536     63   121.66908,31.816983   \n",
       "726178  11172  121.51107,32.05536     64  121.185719,32.351002   \n",
       "726179  11172  121.51107,32.05536     65  120.556805,32.385662   \n",
       "\n",
       "       duration_distance_bicycling  \n",
       "0                      16982,70758  \n",
       "1                      16380,68251  \n",
       "2                      17363,72345  \n",
       "3                      13113,54638  \n",
       "4                       3712,15466  \n",
       "...                            ...  \n",
       "726175                 14291,59545  \n",
       "726176                32377,134904  \n",
       "726177                 10048,41869  \n",
       "726178                 14223,59263  \n",
       "726179                27395,114148  \n",
       "\n",
       "[726180 rows x 5 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res = pd.DataFrame()\n",
    "for i in range(1,26):\n",
    "    file_name = 'fp' + str(i) + '.xlsx'\n",
    "    df = pd.read_excel(file_name)[['居民点id','居民点location','设施点id','设施点location','duration_distance_bicycling']]\n",
    "    res = pd.concat([res, df],ignore_index=True)\n",
    "res"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>居民点id</th>\n",
       "      <th>居民点location</th>\n",
       "      <th>设施点id</th>\n",
       "      <th>设施点location</th>\n",
       "      <th>duration_distance_bicycling</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>1</td>\n",
       "      <td>119.9242,32.49087</td>\n",
       "      <td>16982,70758</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>2</td>\n",
       "      <td>119.900891,32.459968</td>\n",
       "      <td>16380,68251</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>3</td>\n",
       "      <td>119.9201,32.500119</td>\n",
       "      <td>17363,72345</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>4</td>\n",
       "      <td>119.882343,32.324787</td>\n",
       "      <td>13113,54638</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>5</td>\n",
       "      <td>120.273972,32.021327</td>\n",
       "      <td>3712,15466</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1374151</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>119</td>\n",
       "      <td>120.1324575,32.73147308</td>\n",
       "      <td>43802,182508</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1374152</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>120</td>\n",
       "      <td>120.2076613,32.93189058</td>\n",
       "      <td>46305,192941</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1374153</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>121</td>\n",
       "      <td>120.0969593,33.09339937</td>\n",
       "      <td>52707,219613</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1374154</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>122</td>\n",
       "      <td>119.7267822,33.1477952</td>\n",
       "      <td>60989,254124</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1374155</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>123</td>\n",
       "      <td>119.8842717,32.70792531</td>\n",
       "      <td>48845,203524</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1374156 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         居民点id         居民点location  设施点id              设施点location  \\\n",
       "0            1  120.15568,31.97798      1        119.9242,32.49087   \n",
       "1            1  120.15568,31.97798      2     119.900891,32.459968   \n",
       "2            1  120.15568,31.97798      3       119.9201,32.500119   \n",
       "3            1  120.15568,31.97798      4     119.882343,32.324787   \n",
       "4            1  120.15568,31.97798      5     120.273972,32.021327   \n",
       "...        ...                 ...    ...                      ...   \n",
       "1374151  11172  121.51107,32.05536    119  120.1324575,32.73147308   \n",
       "1374152  11172  121.51107,32.05536    120  120.2076613,32.93189058   \n",
       "1374153  11172  121.51107,32.05536    121  120.0969593,33.09339937   \n",
       "1374154  11172  121.51107,32.05536    122   119.7267822,33.1477952   \n",
       "1374155  11172  121.51107,32.05536    123  119.8842717,32.70792531   \n",
       "\n",
       "        duration_distance_bicycling  \n",
       "0                       16982,70758  \n",
       "1                       16380,68251  \n",
       "2                       17363,72345  \n",
       "3                       13113,54638  \n",
       "4                        3712,15466  \n",
       "...                             ...  \n",
       "1374151                43802,182508  \n",
       "1374152                46305,192941  \n",
       "1374153                52707,219613  \n",
       "1374154                60989,254124  \n",
       "1374155                48845,203524  \n",
       "\n",
       "[1374156 rows x 5 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "for i in range(1, 23):\n",
    "    file_name = 'sp' + str(i) + '.xlsx'\n",
    "    df = pd.read_excel(file_name)[['居民点id','居民点location','设施点id','设施点location','duration_distance_bicycling']]\n",
    "    res = pd.concat([res, df],ignore_index=True)\n",
    "res"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>居民点id</th>\n",
       "      <th>居民点location</th>\n",
       "      <th>设施点id</th>\n",
       "      <th>设施点location</th>\n",
       "      <th>duration_distance_bicycling</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>66</td>\n",
       "      <td>120.6106005,32.57342318</td>\n",
       "      <td>23830,99294</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>67</td>\n",
       "      <td>120.2771004,32.59456443</td>\n",
       "      <td>20949,87290</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>68</td>\n",
       "      <td>120.3160269,32.50859189</td>\n",
       "      <td>18336,76401</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>69</td>\n",
       "      <td>120.6964243,32.57022363</td>\n",
       "      <td>25007,104198</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>32870,136958</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>150008</th>\n",
       "      <td>8674</td>\n",
       "      <td>120.35501,32.07072</td>\n",
       "      <td>81</td>\n",
       "      <td>120.7494508,32.1020372</td>\n",
       "      <td>10496,43734</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>150009</th>\n",
       "      <td>10140</td>\n",
       "      <td>120.56642,32.33302</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>26184,109100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>150010</th>\n",
       "      <td>10224</td>\n",
       "      <td>121.29252,32.3091</td>\n",
       "      <td>82</td>\n",
       "      <td>120.9652622,32.21289689</td>\n",
       "      <td>8743,36431</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>150011</th>\n",
       "      <td>10505</td>\n",
       "      <td>121.29151,32.19299</td>\n",
       "      <td>99</td>\n",
       "      <td>119.7594763,32.61854162</td>\n",
       "      <td>41975,174898</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>150012</th>\n",
       "      <td>10968</td>\n",
       "      <td>121.22701,32.28569</td>\n",
       "      <td>119</td>\n",
       "      <td>120.1324575,32.73147308</td>\n",
       "      <td>32184,134102</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>150013 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        居民点id         居民点location  设施点id              设施点location  \\\n",
       "0           1  120.15568,31.97798     66  120.6106005,32.57342318   \n",
       "1           1  120.15568,31.97798     67  120.2771004,32.59456443   \n",
       "2           1  120.15568,31.97798     68  120.3160269,32.50859189   \n",
       "3           1  120.15568,31.97798     69  120.6964243,32.57022363   \n",
       "4           1  120.15568,31.97798     70  121.4841706,32.05601369   \n",
       "...       ...                 ...    ...                      ...   \n",
       "150008   8674  120.35501,32.07072     81   120.7494508,32.1020372   \n",
       "150009  10140  120.56642,32.33302     70  121.4841706,32.05601369   \n",
       "150010  10224   121.29252,32.3091     82  120.9652622,32.21289689   \n",
       "150011  10505  121.29151,32.19299     99  119.7594763,32.61854162   \n",
       "150012  10968  121.22701,32.28569    119  120.1324575,32.73147308   \n",
       "\n",
       "       duration_distance_bicycling  \n",
       "0                      23830,99294  \n",
       "1                      20949,87290  \n",
       "2                      18336,76401  \n",
       "3                     25007,104198  \n",
       "4                     32870,136958  \n",
       "...                            ...  \n",
       "150008                 10496,43734  \n",
       "150009                26184,109100  \n",
       "150010                  8743,36431  \n",
       "150011                41975,174898  \n",
       "150012                32184,134102  \n",
       "\n",
       "[150013 rows x 5 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 补全数据\n",
    "rest = pd.DataFrame()\n",
    "for i in range(1, 6):\n",
    "    file_name = 'undo' + str(i) + '.xlsx'\n",
    "    df = pd.read_excel(file_name)[['居民点id','居民点location','设施点id','设施点location','duration_distance_bicycling']]\n",
    "    rest = pd.concat([rest, df],ignore_index=True)\n",
    "rest"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>居民点id</th>\n",
       "      <th>居民点location</th>\n",
       "      <th>设施点id</th>\n",
       "      <th>设施点location</th>\n",
       "      <th>duration_distance_bicycling</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>1</td>\n",
       "      <td>119.9242,32.49087</td>\n",
       "      <td>16982,70758</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>2</td>\n",
       "      <td>119.900891,32.459968</td>\n",
       "      <td>16380,68251</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>3</td>\n",
       "      <td>119.9201,32.500119</td>\n",
       "      <td>17363,72345</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>4</td>\n",
       "      <td>119.882343,32.324787</td>\n",
       "      <td>13113,54638</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>5</td>\n",
       "      <td>120.273972,32.021327</td>\n",
       "      <td>3712,15466</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1374027</th>\n",
       "      <td>8674</td>\n",
       "      <td>120.35501,32.07072</td>\n",
       "      <td>81</td>\n",
       "      <td>120.7494508,32.1020372</td>\n",
       "      <td>10496,43734</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1374028</th>\n",
       "      <td>10140</td>\n",
       "      <td>120.56642,32.33302</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>26184,109100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1374029</th>\n",
       "      <td>10224</td>\n",
       "      <td>121.29252,32.3091</td>\n",
       "      <td>82</td>\n",
       "      <td>120.9652622,32.21289689</td>\n",
       "      <td>8743,36431</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1374030</th>\n",
       "      <td>10505</td>\n",
       "      <td>121.29151,32.19299</td>\n",
       "      <td>99</td>\n",
       "      <td>119.7594763,32.61854162</td>\n",
       "      <td>41975,174898</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1374031</th>\n",
       "      <td>10968</td>\n",
       "      <td>121.22701,32.28569</td>\n",
       "      <td>119</td>\n",
       "      <td>120.1324575,32.73147308</td>\n",
       "      <td>32184,134102</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1374032 rows × 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         居民点id         居民点location  设施点id              设施点location  \\\n",
       "0            1  120.15568,31.97798      1        119.9242,32.49087   \n",
       "1            1  120.15568,31.97798      2     119.900891,32.459968   \n",
       "2            1  120.15568,31.97798      3       119.9201,32.500119   \n",
       "3            1  120.15568,31.97798      4     119.882343,32.324787   \n",
       "4            1  120.15568,31.97798      5     120.273972,32.021327   \n",
       "...        ...                 ...    ...                      ...   \n",
       "1374027   8674  120.35501,32.07072     81   120.7494508,32.1020372   \n",
       "1374028  10140  120.56642,32.33302     70  121.4841706,32.05601369   \n",
       "1374029  10224   121.29252,32.3091     82  120.9652622,32.21289689   \n",
       "1374030  10505  121.29151,32.19299     99  119.7594763,32.61854162   \n",
       "1374031  10968  121.22701,32.28569    119  120.1324575,32.73147308   \n",
       "\n",
       "        duration_distance_bicycling  \n",
       "0                       16982,70758  \n",
       "1                       16380,68251  \n",
       "2                       17363,72345  \n",
       "3                       13113,54638  \n",
       "4                        3712,15466  \n",
       "...                             ...  \n",
       "1374027                 10496,43734  \n",
       "1374028                26184,109100  \n",
       "1374029                  8743,36431  \n",
       "1374030                41975,174898  \n",
       "1374031                32184,134102  \n",
       "\n",
       "[1374032 rows x 5 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 检查是否有缺失数据\n",
    "done = res[res['duration_distance_bicycling']!=',']\n",
    "total_df = pd.concat([done, rest], ignore_index=True)\n",
    "total_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "ssd_79 = pd.read_excel('ssd79_bicycling.xlsx')[['居民点id','居民点location','设施点id','设施点location','duration_distance_bicycling']]\n",
    "ssd_79"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 第一步：在130万行OD矩阵骑行.xsl 中用第49个医疗点的OD矩阵替换到第80个医疗点的OD矩阵，并把第49个医疗点的OD矩阵删掉，原有序号不变（没有第49个医疗点）\n",
    "# 第二步:第79个医疗点ID改为120.51244，32.137315计算骑行OD矩阵，并替换原有第79个医疗点的OD矩阵\n",
    "result = total_df[~total_df['设施点id'].isin([79,80])]\n",
    "result = pd.concat([result, ssd_79], ignore_index=True)\n",
    "\n",
    "result['设施点id'] = result['设施点id'].replace({49:80})"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>居民点id</th>\n",
       "      <th>居民点location</th>\n",
       "      <th>设施点id</th>\n",
       "      <th>设施点location</th>\n",
       "      <th>duration_distance_bicycling</th>\n",
       "      <th>duration</th>\n",
       "      <th>distance</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>1</td>\n",
       "      <td>119.9242,32.49087</td>\n",
       "      <td>16982,70758</td>\n",
       "      <td>16982.0</td>\n",
       "      <td>70758.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>2</td>\n",
       "      <td>119.900891,32.459968</td>\n",
       "      <td>16380,68251</td>\n",
       "      <td>16380.0</td>\n",
       "      <td>68251.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>3</td>\n",
       "      <td>119.9201,32.500119</td>\n",
       "      <td>17363,72345</td>\n",
       "      <td>17363.0</td>\n",
       "      <td>72345.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>4</td>\n",
       "      <td>119.882343,32.324787</td>\n",
       "      <td>13113,54638</td>\n",
       "      <td>13113.0</td>\n",
       "      <td>54638.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>5</td>\n",
       "      <td>120.273972,32.021327</td>\n",
       "      <td>3712,15466</td>\n",
       "      <td>3712.0</td>\n",
       "      <td>15466.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1362855</th>\n",
       "      <td>11168</td>\n",
       "      <td>121.51557,32.02781</td>\n",
       "      <td>79</td>\n",
       "      <td>120.51244,32.137315</td>\n",
       "      <td>25175,104898</td>\n",
       "      <td>25175.0</td>\n",
       "      <td>104898.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1362856</th>\n",
       "      <td>11169</td>\n",
       "      <td>121.51746,32.03974</td>\n",
       "      <td>79</td>\n",
       "      <td>120.51244,32.137315</td>\n",
       "      <td>25274,105311</td>\n",
       "      <td>25274.0</td>\n",
       "      <td>105311.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1362857</th>\n",
       "      <td>11170</td>\n",
       "      <td>121.50454,32.04188</td>\n",
       "      <td>79</td>\n",
       "      <td>120.51244,32.137315</td>\n",
       "      <td>25060,104418</td>\n",
       "      <td>25060.0</td>\n",
       "      <td>104418.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1362858</th>\n",
       "      <td>11171</td>\n",
       "      <td>121.50935,32.04287</td>\n",
       "      <td>79</td>\n",
       "      <td>120.51244,32.137315</td>\n",
       "      <td>25175,104898</td>\n",
       "      <td>25175.0</td>\n",
       "      <td>104898.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1362859</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>79</td>\n",
       "      <td>120.51244,32.137315</td>\n",
       "      <td>24972,104052</td>\n",
       "      <td>24972.0</td>\n",
       "      <td>104052.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1362860 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         居民点id         居民点location  设施点id           设施点location  \\\n",
       "0            1  120.15568,31.97798      1     119.9242,32.49087   \n",
       "1            1  120.15568,31.97798      2  119.900891,32.459968   \n",
       "2            1  120.15568,31.97798      3    119.9201,32.500119   \n",
       "3            1  120.15568,31.97798      4  119.882343,32.324787   \n",
       "4            1  120.15568,31.97798      5  120.273972,32.021327   \n",
       "...        ...                 ...    ...                   ...   \n",
       "1362855  11168  121.51557,32.02781     79   120.51244,32.137315   \n",
       "1362856  11169  121.51746,32.03974     79   120.51244,32.137315   \n",
       "1362857  11170  121.50454,32.04188     79   120.51244,32.137315   \n",
       "1362858  11171  121.50935,32.04287     79   120.51244,32.137315   \n",
       "1362859  11172  121.51107,32.05536     79   120.51244,32.137315   \n",
       "\n",
       "        duration_distance_bicycling  duration  distance  \n",
       "0                       16982,70758   16982.0   70758.0  \n",
       "1                       16380,68251   16380.0   68251.0  \n",
       "2                       17363,72345   17363.0   72345.0  \n",
       "3                       13113,54638   13113.0   54638.0  \n",
       "4                        3712,15466    3712.0   15466.0  \n",
       "...                             ...       ...       ...  \n",
       "1362855                25175,104898   25175.0  104898.0  \n",
       "1362856                25274,105311   25274.0  105311.0  \n",
       "1362857                25060,104418   25060.0  104418.0  \n",
       "1362858                25175,104898   25175.0  104898.0  \n",
       "1362859                24972,104052   24972.0  104052.0  \n",
       "\n",
       "[1362860 rows x 7 columns]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "result['duration'] = pd.to_numeric(result['duration_distance_bicycling'].str.split(',').str[0])\n",
    "result['distance'] = pd.to_numeric(result['duration_distance_bicycling'].str.split(',').str[1])\n",
    "result"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([  1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,\n",
       "        14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,\n",
       "        27,  28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,\n",
       "        40,  41,  42,  43,  44,  45,  46,  47,  48,  80,  50,  51,  52,\n",
       "        53,  54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,  65,\n",
       "        72,  78,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,  91,\n",
       "        92,  93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103, 104,\n",
       "       105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117,\n",
       "       118, 119, 120, 121, 122, 123,  66,  67,  68,  69,  70,  71,  73,\n",
       "        74,  75,  76,  77,  79])"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "result['设施点id'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>居民点id</th>\n",
       "      <th>居民点location</th>\n",
       "      <th>设施点id</th>\n",
       "      <th>设施点location</th>\n",
       "      <th>duration_distance_bicycling</th>\n",
       "      <th>duration</th>\n",
       "      <th>distance</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1209502</th>\n",
       "      <td>48</td>\n",
       "      <td>120.23605,31.96103</td>\n",
       "      <td>91</td>\n",
       "      <td>119.6400684,32.88772162</td>\n",
       "      <td>,</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1229553</th>\n",
       "      <td>406</td>\n",
       "      <td>121.01951,31.98991</td>\n",
       "      <td>94</td>\n",
       "      <td>119.2458507,32.53600868</td>\n",
       "      <td>,</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1232938</th>\n",
       "      <td>466</td>\n",
       "      <td>121.13333,31.91743</td>\n",
       "      <td>119</td>\n",
       "      <td>120.1324575,32.73147308</td>\n",
       "      <td>,</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1260700</th>\n",
       "      <td>962</td>\n",
       "      <td>121.83164,31.70538</td>\n",
       "      <td>105</td>\n",
       "      <td>120.0856048,32.64152913</td>\n",
       "      <td>,</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1296317</th>\n",
       "      <td>1598</td>\n",
       "      <td>119.42646,33.24128</td>\n",
       "      <td>106</td>\n",
       "      <td>120.0473103,32.41528753</td>\n",
       "      <td>,</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1325250</th>\n",
       "      <td>2115</td>\n",
       "      <td>119.44032,32.79676</td>\n",
       "      <td>88</td>\n",
       "      <td>119.5464931,33.15443148</td>\n",
       "      <td>,</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1337786</th>\n",
       "      <td>2339</td>\n",
       "      <td>119.94869,32.74205</td>\n",
       "      <td>78</td>\n",
       "      <td>121.0423473,32.31547999</td>\n",
       "      <td>,</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         居民点id         居民点location  设施点id              设施点location  \\\n",
       "1209502     48  120.23605,31.96103     91  119.6400684,32.88772162   \n",
       "1229553    406  121.01951,31.98991     94  119.2458507,32.53600868   \n",
       "1232938    466  121.13333,31.91743    119  120.1324575,32.73147308   \n",
       "1260700    962  121.83164,31.70538    105  120.0856048,32.64152913   \n",
       "1296317   1598  119.42646,33.24128    106  120.0473103,32.41528753   \n",
       "1325250   2115  119.44032,32.79676     88  119.5464931,33.15443148   \n",
       "1337786   2339  119.94869,32.74205     78  121.0423473,32.31547999   \n",
       "\n",
       "        duration_distance_bicycling  duration  distance  \n",
       "1209502                           ,       NaN       NaN  \n",
       "1229553                           ,       NaN       NaN  \n",
       "1232938                           ,       NaN       NaN  \n",
       "1260700                           ,       NaN       NaN  \n",
       "1296317                           ,       NaN       NaN  \n",
       "1325250                           ,       NaN       NaN  \n",
       "1337786                           ,       NaN       NaN  "
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "result[result['duration_distance_bicycling']==',']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "result.set_index('居民点id').to_csv('./bicycling/骑行OD矩阵.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>居民点id</th>\n",
       "      <th>居民点location</th>\n",
       "      <th>设施点id</th>\n",
       "      <th>设施点location</th>\n",
       "      <th>duration_distance_bicycling</th>\n",
       "      <th>duration</th>\n",
       "      <th>distance</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1206889</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>110</td>\n",
       "      <td>120.2273342,31.98330751</td>\n",
       "      <td>1897,7903</td>\n",
       "      <td>1897.0</td>\n",
       "      <td>7903.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206944</th>\n",
       "      <td>2</td>\n",
       "      <td>120.05855,31.98966</td>\n",
       "      <td>109</td>\n",
       "      <td>120.092621,31.99860122</td>\n",
       "      <td>1103,4594</td>\n",
       "      <td>1103.0</td>\n",
       "      <td>4594.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1207000</th>\n",
       "      <td>3</td>\n",
       "      <td>120.04138,31.99845</td>\n",
       "      <td>109</td>\n",
       "      <td>120.092621,31.99860122</td>\n",
       "      <td>1308,5450</td>\n",
       "      <td>1308.0</td>\n",
       "      <td>5450.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1207056</th>\n",
       "      <td>4</td>\n",
       "      <td>120.05722,31.97957</td>\n",
       "      <td>109</td>\n",
       "      <td>120.092621,31.99860122</td>\n",
       "      <td>1371,5711</td>\n",
       "      <td>1371.0</td>\n",
       "      <td>5711.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1207112</th>\n",
       "      <td>5</td>\n",
       "      <td>120.05374,31.9833</td>\n",
       "      <td>109</td>\n",
       "      <td>120.092621,31.99860122</td>\n",
       "      <td>1354,5642</td>\n",
       "      <td>1354.0</td>\n",
       "      <td>5642.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206571</th>\n",
       "      <td>11168</td>\n",
       "      <td>121.51557,32.02781</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>1255,5228</td>\n",
       "      <td>1255.0</td>\n",
       "      <td>5228.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206627</th>\n",
       "      <td>11169</td>\n",
       "      <td>121.51746,32.03974</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>1160,4835</td>\n",
       "      <td>1160.0</td>\n",
       "      <td>4835.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206683</th>\n",
       "      <td>11170</td>\n",
       "      <td>121.50454,32.04188</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>946,3942</td>\n",
       "      <td>946.0</td>\n",
       "      <td>3942.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206739</th>\n",
       "      <td>11171</td>\n",
       "      <td>121.50935,32.04287</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>1061,4422</td>\n",
       "      <td>1061.0</td>\n",
       "      <td>4422.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206795</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>752,3133</td>\n",
       "      <td>752.0</td>\n",
       "      <td>3133.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>11172 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         居民点id         居民点location  设施点id              设施点location  \\\n",
       "1206889      1  120.15568,31.97798    110  120.2273342,31.98330751   \n",
       "1206944      2  120.05855,31.98966    109   120.092621,31.99860122   \n",
       "1207000      3  120.04138,31.99845    109   120.092621,31.99860122   \n",
       "1207056      4  120.05722,31.97957    109   120.092621,31.99860122   \n",
       "1207112      5   120.05374,31.9833    109   120.092621,31.99860122   \n",
       "...        ...                 ...    ...                      ...   \n",
       "1206571  11168  121.51557,32.02781     70  121.4841706,32.05601369   \n",
       "1206627  11169  121.51746,32.03974     70  121.4841706,32.05601369   \n",
       "1206683  11170  121.50454,32.04188     70  121.4841706,32.05601369   \n",
       "1206739  11171  121.50935,32.04287     70  121.4841706,32.05601369   \n",
       "1206795  11172  121.51107,32.05536     70  121.4841706,32.05601369   \n",
       "\n",
       "        duration_distance_bicycling  duration  distance  \n",
       "1206889                   1897,7903    1897.0    7903.0  \n",
       "1206944                   1103,4594    1103.0    4594.0  \n",
       "1207000                   1308,5450    1308.0    5450.0  \n",
       "1207056                   1371,5711    1371.0    5711.0  \n",
       "1207112                   1354,5642    1354.0    5642.0  \n",
       "...                             ...       ...       ...  \n",
       "1206571                   1255,5228    1255.0    5228.0  \n",
       "1206627                   1160,4835    1160.0    4835.0  \n",
       "1206683                    946,3942     946.0    3942.0  \n",
       "1206739                   1061,4422    1061.0    4422.0  \n",
       "1206795                    752,3133     752.0    3133.0  \n",
       "\n",
       "[11172 rows x 7 columns]"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 最小时间\n",
    "min_time = result.sort_values(by='duration')\\\n",
    "            .groupby(by='居民点id')\\\n",
    "            .head(1)\\\n",
    "            .sort_values(by='居民点id')\n",
    "min_time[['居民点id','居民点location','设施点id','设施点location','duration']].set_index('居民点id').to_excel('./bicycling/骑行OD矩阵最小时间.xlsx')\n",
    "min_time"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>居民点id</th>\n",
       "      <th>居民点location</th>\n",
       "      <th>设施点id</th>\n",
       "      <th>设施点location</th>\n",
       "      <th>duration_distance_bicycling</th>\n",
       "      <th>duration</th>\n",
       "      <th>distance</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1206889</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>110</td>\n",
       "      <td>120.2273342,31.98330751</td>\n",
       "      <td>1897,7903</td>\n",
       "      <td>1897.0</td>\n",
       "      <td>7903.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206944</th>\n",
       "      <td>2</td>\n",
       "      <td>120.05855,31.98966</td>\n",
       "      <td>109</td>\n",
       "      <td>120.092621,31.99860122</td>\n",
       "      <td>1103,4594</td>\n",
       "      <td>1103.0</td>\n",
       "      <td>4594.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1207000</th>\n",
       "      <td>3</td>\n",
       "      <td>120.04138,31.99845</td>\n",
       "      <td>109</td>\n",
       "      <td>120.092621,31.99860122</td>\n",
       "      <td>1308,5450</td>\n",
       "      <td>1308.0</td>\n",
       "      <td>5450.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1207056</th>\n",
       "      <td>4</td>\n",
       "      <td>120.05722,31.97957</td>\n",
       "      <td>109</td>\n",
       "      <td>120.092621,31.99860122</td>\n",
       "      <td>1371,5711</td>\n",
       "      <td>1371.0</td>\n",
       "      <td>5711.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1207112</th>\n",
       "      <td>5</td>\n",
       "      <td>120.05374,31.9833</td>\n",
       "      <td>109</td>\n",
       "      <td>120.092621,31.99860122</td>\n",
       "      <td>1354,5642</td>\n",
       "      <td>1354.0</td>\n",
       "      <td>5642.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206571</th>\n",
       "      <td>11168</td>\n",
       "      <td>121.51557,32.02781</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>1255,5228</td>\n",
       "      <td>1255.0</td>\n",
       "      <td>5228.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206627</th>\n",
       "      <td>11169</td>\n",
       "      <td>121.51746,32.03974</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>1160,4835</td>\n",
       "      <td>1160.0</td>\n",
       "      <td>4835.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206683</th>\n",
       "      <td>11170</td>\n",
       "      <td>121.50454,32.04188</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>946,3942</td>\n",
       "      <td>946.0</td>\n",
       "      <td>3942.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206739</th>\n",
       "      <td>11171</td>\n",
       "      <td>121.50935,32.04287</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>1061,4422</td>\n",
       "      <td>1061.0</td>\n",
       "      <td>4422.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206795</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>752,3133</td>\n",
       "      <td>752.0</td>\n",
       "      <td>3133.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>11172 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         居民点id         居民点location  设施点id              设施点location  \\\n",
       "1206889      1  120.15568,31.97798    110  120.2273342,31.98330751   \n",
       "1206944      2  120.05855,31.98966    109   120.092621,31.99860122   \n",
       "1207000      3  120.04138,31.99845    109   120.092621,31.99860122   \n",
       "1207056      4  120.05722,31.97957    109   120.092621,31.99860122   \n",
       "1207112      5   120.05374,31.9833    109   120.092621,31.99860122   \n",
       "...        ...                 ...    ...                      ...   \n",
       "1206571  11168  121.51557,32.02781     70  121.4841706,32.05601369   \n",
       "1206627  11169  121.51746,32.03974     70  121.4841706,32.05601369   \n",
       "1206683  11170  121.50454,32.04188     70  121.4841706,32.05601369   \n",
       "1206739  11171  121.50935,32.04287     70  121.4841706,32.05601369   \n",
       "1206795  11172  121.51107,32.05536     70  121.4841706,32.05601369   \n",
       "\n",
       "        duration_distance_bicycling  duration  distance  \n",
       "1206889                   1897,7903    1897.0    7903.0  \n",
       "1206944                   1103,4594    1103.0    4594.0  \n",
       "1207000                   1308,5450    1308.0    5450.0  \n",
       "1207056                   1371,5711    1371.0    5711.0  \n",
       "1207112                   1354,5642    1354.0    5642.0  \n",
       "...                             ...       ...       ...  \n",
       "1206571                   1255,5228    1255.0    5228.0  \n",
       "1206627                   1160,4835    1160.0    4835.0  \n",
       "1206683                    946,3942     946.0    3942.0  \n",
       "1206739                   1061,4422    1061.0    4422.0  \n",
       "1206795                    752,3133     752.0    3133.0  \n",
       "\n",
       "[11172 rows x 7 columns]"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 最小距离\n",
    "min_distance = result.sort_values(by='distance')\\\n",
    "            .groupby(by='居民点id')\\\n",
    "            .head(1)\\\n",
    "            .sort_values(by='居民点id')\n",
    "min_distance[['居民点id','居民点location','设施点id','设施点location','distance']].set_index('居民点id').to_excel('./bicycling/骑行OD矩阵最小距离.xlsx')\n",
    "min_distance"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>居民点id</th>\n",
       "      <th>居民点location</th>\n",
       "      <th>设施点id</th>\n",
       "      <th>设施点location</th>\n",
       "      <th>duration_distance_bicycling</th>\n",
       "      <th>duration</th>\n",
       "      <th>distance</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>1</td>\n",
       "      <td>119.9242,32.49087</td>\n",
       "      <td>16982,70758</td>\n",
       "      <td>16982.0</td>\n",
       "      <td>70758.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>2</td>\n",
       "      <td>119.900891,32.459968</td>\n",
       "      <td>16380,68251</td>\n",
       "      <td>16380.0</td>\n",
       "      <td>68251.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>3</td>\n",
       "      <td>119.9201,32.500119</td>\n",
       "      <td>17363,72345</td>\n",
       "      <td>17363.0</td>\n",
       "      <td>72345.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>4</td>\n",
       "      <td>119.882343,32.324787</td>\n",
       "      <td>13113,54638</td>\n",
       "      <td>13113.0</td>\n",
       "      <td>54638.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>5</td>\n",
       "      <td>120.273972,32.021327</td>\n",
       "      <td>3712,15466</td>\n",
       "      <td>3712.0</td>\n",
       "      <td>15466.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>726051</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>61</td>\n",
       "      <td>121.007933,31.929588</td>\n",
       "      <td>14291,59545</td>\n",
       "      <td>14291.0</td>\n",
       "      <td>59545.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>726052</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>62</td>\n",
       "      <td>120.467338,32.542238</td>\n",
       "      <td>32377,134904</td>\n",
       "      <td>32377.0</td>\n",
       "      <td>134904.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>726053</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>63</td>\n",
       "      <td>121.66908,31.816983</td>\n",
       "      <td>10048,41869</td>\n",
       "      <td>10048.0</td>\n",
       "      <td>41869.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>726054</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>64</td>\n",
       "      <td>121.185719,32.351002</td>\n",
       "      <td>14223,59263</td>\n",
       "      <td>14223.0</td>\n",
       "      <td>59263.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>726055</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>65</td>\n",
       "      <td>120.556805,32.385662</td>\n",
       "      <td>27395,114148</td>\n",
       "      <td>27395.0</td>\n",
       "      <td>114148.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>714885 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        居民点id         居民点location  设施点id           设施点location  \\\n",
       "0           1  120.15568,31.97798      1     119.9242,32.49087   \n",
       "1           1  120.15568,31.97798      2  119.900891,32.459968   \n",
       "2           1  120.15568,31.97798      3    119.9201,32.500119   \n",
       "3           1  120.15568,31.97798      4  119.882343,32.324787   \n",
       "4           1  120.15568,31.97798      5  120.273972,32.021327   \n",
       "...       ...                 ...    ...                   ...   \n",
       "726051  11172  121.51107,32.05536     61  121.007933,31.929588   \n",
       "726052  11172  121.51107,32.05536     62  120.467338,32.542238   \n",
       "726053  11172  121.51107,32.05536     63   121.66908,31.816983   \n",
       "726054  11172  121.51107,32.05536     64  121.185719,32.351002   \n",
       "726055  11172  121.51107,32.05536     65  120.556805,32.385662   \n",
       "\n",
       "       duration_distance_bicycling  duration  distance  \n",
       "0                      16982,70758   16982.0   70758.0  \n",
       "1                      16380,68251   16380.0   68251.0  \n",
       "2                      17363,72345   17363.0   72345.0  \n",
       "3                      13113,54638   13113.0   54638.0  \n",
       "4                       3712,15466    3712.0   15466.0  \n",
       "...                            ...       ...       ...  \n",
       "726051                 14291,59545   14291.0   59545.0  \n",
       "726052                32377,134904   32377.0  134904.0  \n",
       "726053                 10048,41869   10048.0   41869.0  \n",
       "726054                 14223,59263   14223.0   59263.0  \n",
       "726055                27395,114148   27395.0  114148.0  \n",
       "\n",
       "[714885 rows x 7 columns]"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res_1_65 = result[(result['设施点id']>=1) & (result['设施点id']<=65)]\n",
    "res_1_65"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "64"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res_1_65['设施点id'].nunique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [],
   "source": [
    "res_1_65.set_index('居民点id').to_excel('./bicycling/骑行OD矩阵1-65.xlsx')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>居民点id</th>\n",
       "      <th>居民点location</th>\n",
       "      <th>设施点id</th>\n",
       "      <th>设施点location</th>\n",
       "      <th>duration_distance_bicycling</th>\n",
       "      <th>duration</th>\n",
       "      <th>distance</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>17</td>\n",
       "      <td>120.252981,32.022921</td>\n",
       "      <td>3319,13831</td>\n",
       "      <td>3319.0</td>\n",
       "      <td>13831.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>70</th>\n",
       "      <td>2</td>\n",
       "      <td>120.05855,31.98966</td>\n",
       "      <td>6</td>\n",
       "      <td>120.016761,32.16356</td>\n",
       "      <td>5604,23349</td>\n",
       "      <td>5604.0</td>\n",
       "      <td>23349.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>135</th>\n",
       "      <td>3</td>\n",
       "      <td>120.04138,31.99845</td>\n",
       "      <td>6</td>\n",
       "      <td>120.016761,32.16356</td>\n",
       "      <td>5450,22708</td>\n",
       "      <td>5450.0</td>\n",
       "      <td>22708.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>200</th>\n",
       "      <td>4</td>\n",
       "      <td>120.05722,31.97957</td>\n",
       "      <td>6</td>\n",
       "      <td>120.016761,32.16356</td>\n",
       "      <td>5883,24514</td>\n",
       "      <td>5883.0</td>\n",
       "      <td>24514.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>265</th>\n",
       "      <td>5</td>\n",
       "      <td>120.05374,31.9833</td>\n",
       "      <td>6</td>\n",
       "      <td>120.016761,32.16356</td>\n",
       "      <td>5698,23740</td>\n",
       "      <td>5698.0</td>\n",
       "      <td>23740.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>725789</th>\n",
       "      <td>11168</td>\n",
       "      <td>121.51557,32.02781</td>\n",
       "      <td>59</td>\n",
       "      <td>121.277079,32.011241</td>\n",
       "      <td>6280,26168</td>\n",
       "      <td>6280.0</td>\n",
       "      <td>26168.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>725854</th>\n",
       "      <td>11169</td>\n",
       "      <td>121.51746,32.03974</td>\n",
       "      <td>59</td>\n",
       "      <td>121.277079,32.011241</td>\n",
       "      <td>6379,26581</td>\n",
       "      <td>6379.0</td>\n",
       "      <td>26581.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>725919</th>\n",
       "      <td>11170</td>\n",
       "      <td>121.50454,32.04188</td>\n",
       "      <td>59</td>\n",
       "      <td>121.277079,32.011241</td>\n",
       "      <td>6165,25688</td>\n",
       "      <td>6165.0</td>\n",
       "      <td>25688.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>725984</th>\n",
       "      <td>11171</td>\n",
       "      <td>121.50935,32.04287</td>\n",
       "      <td>59</td>\n",
       "      <td>121.277079,32.011241</td>\n",
       "      <td>6280,26168</td>\n",
       "      <td>6280.0</td>\n",
       "      <td>26168.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>726049</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>59</td>\n",
       "      <td>121.277079,32.011241</td>\n",
       "      <td>6262,26093</td>\n",
       "      <td>6262.0</td>\n",
       "      <td>26093.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>11172 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        居民点id         居民点location  设施点id           设施点location  \\\n",
       "16          1  120.15568,31.97798     17  120.252981,32.022921   \n",
       "70          2  120.05855,31.98966      6   120.016761,32.16356   \n",
       "135         3  120.04138,31.99845      6   120.016761,32.16356   \n",
       "200         4  120.05722,31.97957      6   120.016761,32.16356   \n",
       "265         5   120.05374,31.9833      6   120.016761,32.16356   \n",
       "...       ...                 ...    ...                   ...   \n",
       "725789  11168  121.51557,32.02781     59  121.277079,32.011241   \n",
       "725854  11169  121.51746,32.03974     59  121.277079,32.011241   \n",
       "725919  11170  121.50454,32.04188     59  121.277079,32.011241   \n",
       "725984  11171  121.50935,32.04287     59  121.277079,32.011241   \n",
       "726049  11172  121.51107,32.05536     59  121.277079,32.011241   \n",
       "\n",
       "       duration_distance_bicycling  duration  distance  \n",
       "16                      3319,13831    3319.0   13831.0  \n",
       "70                      5604,23349    5604.0   23349.0  \n",
       "135                     5450,22708    5450.0   22708.0  \n",
       "200                     5883,24514    5883.0   24514.0  \n",
       "265                     5698,23740    5698.0   23740.0  \n",
       "...                            ...       ...       ...  \n",
       "725789                  6280,26168    6280.0   26168.0  \n",
       "725854                  6379,26581    6379.0   26581.0  \n",
       "725919                  6165,25688    6165.0   25688.0  \n",
       "725984                  6280,26168    6280.0   26168.0  \n",
       "726049                  6262,26093    6262.0   26093.0  \n",
       "\n",
       "[11172 rows x 7 columns]"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 最小时间\n",
    "min_time1 = res_1_65.sort_values(by='duration')\\\n",
    "            .groupby(by='居民点id')\\\n",
    "            .head(1)\\\n",
    "            .sort_values(by='居民点id')\n",
    "min_time1[['居民点id','居民点location','设施点id','设施点location','duration']].set_index('居民点id').to_excel('./bicycling/骑行OD矩阵最小时间1-65.xlsx')\n",
    "min_time1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>居民点id</th>\n",
       "      <th>居民点location</th>\n",
       "      <th>设施点id</th>\n",
       "      <th>设施点location</th>\n",
       "      <th>duration_distance_bicycling</th>\n",
       "      <th>duration</th>\n",
       "      <th>distance</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>17</td>\n",
       "      <td>120.252981,32.022921</td>\n",
       "      <td>3319,13831</td>\n",
       "      <td>3319.0</td>\n",
       "      <td>13831.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>70</th>\n",
       "      <td>2</td>\n",
       "      <td>120.05855,31.98966</td>\n",
       "      <td>6</td>\n",
       "      <td>120.016761,32.16356</td>\n",
       "      <td>5604,23349</td>\n",
       "      <td>5604.0</td>\n",
       "      <td>23349.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>135</th>\n",
       "      <td>3</td>\n",
       "      <td>120.04138,31.99845</td>\n",
       "      <td>6</td>\n",
       "      <td>120.016761,32.16356</td>\n",
       "      <td>5450,22708</td>\n",
       "      <td>5450.0</td>\n",
       "      <td>22708.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>200</th>\n",
       "      <td>4</td>\n",
       "      <td>120.05722,31.97957</td>\n",
       "      <td>6</td>\n",
       "      <td>120.016761,32.16356</td>\n",
       "      <td>5883,24514</td>\n",
       "      <td>5883.0</td>\n",
       "      <td>24514.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>265</th>\n",
       "      <td>5</td>\n",
       "      <td>120.05374,31.9833</td>\n",
       "      <td>6</td>\n",
       "      <td>120.016761,32.16356</td>\n",
       "      <td>5698,23740</td>\n",
       "      <td>5698.0</td>\n",
       "      <td>23740.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>725789</th>\n",
       "      <td>11168</td>\n",
       "      <td>121.51557,32.02781</td>\n",
       "      <td>59</td>\n",
       "      <td>121.277079,32.011241</td>\n",
       "      <td>6280,26168</td>\n",
       "      <td>6280.0</td>\n",
       "      <td>26168.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>725854</th>\n",
       "      <td>11169</td>\n",
       "      <td>121.51746,32.03974</td>\n",
       "      <td>59</td>\n",
       "      <td>121.277079,32.011241</td>\n",
       "      <td>6379,26581</td>\n",
       "      <td>6379.0</td>\n",
       "      <td>26581.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>725919</th>\n",
       "      <td>11170</td>\n",
       "      <td>121.50454,32.04188</td>\n",
       "      <td>59</td>\n",
       "      <td>121.277079,32.011241</td>\n",
       "      <td>6165,25688</td>\n",
       "      <td>6165.0</td>\n",
       "      <td>25688.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>725984</th>\n",
       "      <td>11171</td>\n",
       "      <td>121.50935,32.04287</td>\n",
       "      <td>59</td>\n",
       "      <td>121.277079,32.011241</td>\n",
       "      <td>6280,26168</td>\n",
       "      <td>6280.0</td>\n",
       "      <td>26168.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>726049</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>59</td>\n",
       "      <td>121.277079,32.011241</td>\n",
       "      <td>6262,26093</td>\n",
       "      <td>6262.0</td>\n",
       "      <td>26093.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>11172 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        居民点id         居民点location  设施点id           设施点location  \\\n",
       "16          1  120.15568,31.97798     17  120.252981,32.022921   \n",
       "70          2  120.05855,31.98966      6   120.016761,32.16356   \n",
       "135         3  120.04138,31.99845      6   120.016761,32.16356   \n",
       "200         4  120.05722,31.97957      6   120.016761,32.16356   \n",
       "265         5   120.05374,31.9833      6   120.016761,32.16356   \n",
       "...       ...                 ...    ...                   ...   \n",
       "725789  11168  121.51557,32.02781     59  121.277079,32.011241   \n",
       "725854  11169  121.51746,32.03974     59  121.277079,32.011241   \n",
       "725919  11170  121.50454,32.04188     59  121.277079,32.011241   \n",
       "725984  11171  121.50935,32.04287     59  121.277079,32.011241   \n",
       "726049  11172  121.51107,32.05536     59  121.277079,32.011241   \n",
       "\n",
       "       duration_distance_bicycling  duration  distance  \n",
       "16                      3319,13831    3319.0   13831.0  \n",
       "70                      5604,23349    5604.0   23349.0  \n",
       "135                     5450,22708    5450.0   22708.0  \n",
       "200                     5883,24514    5883.0   24514.0  \n",
       "265                     5698,23740    5698.0   23740.0  \n",
       "...                            ...       ...       ...  \n",
       "725789                  6280,26168    6280.0   26168.0  \n",
       "725854                  6379,26581    6379.0   26581.0  \n",
       "725919                  6165,25688    6165.0   25688.0  \n",
       "725984                  6280,26168    6280.0   26168.0  \n",
       "726049                  6262,26093    6262.0   26093.0  \n",
       "\n",
       "[11172 rows x 7 columns]"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 最小距离\n",
    "min_distance1 = res_1_65.sort_values(by='distance')\\\n",
    "            .groupby(by='居民点id')\\\n",
    "            .head(1)\\\n",
    "            .sort_values(by='居民点id')\n",
    "min_distance1[['居民点id','居民点location','设施点id','设施点location','distance']].set_index('居民点id').to_excel('./bicycling/骑行OD矩阵最小距离1-65.xlsx')\n",
    "min_distance1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>居民点id</th>\n",
       "      <th>居民点location</th>\n",
       "      <th>设施点id</th>\n",
       "      <th>设施点location</th>\n",
       "      <th>duration_distance_bicycling</th>\n",
       "      <th>duration</th>\n",
       "      <th>distance</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>48</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>80</td>\n",
       "      <td>120.765243,32.241349</td>\n",
       "      <td>17540,73083</td>\n",
       "      <td>17540.0</td>\n",
       "      <td>73083.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>113</th>\n",
       "      <td>2</td>\n",
       "      <td>120.05855,31.98966</td>\n",
       "      <td>80</td>\n",
       "      <td>120.765243,32.241349</td>\n",
       "      <td>19770,82376</td>\n",
       "      <td>19770.0</td>\n",
       "      <td>82376.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>178</th>\n",
       "      <td>3</td>\n",
       "      <td>120.04138,31.99845</td>\n",
       "      <td>80</td>\n",
       "      <td>120.765243,32.241349</td>\n",
       "      <td>20093,83720</td>\n",
       "      <td>20093.0</td>\n",
       "      <td>83720.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>243</th>\n",
       "      <td>4</td>\n",
       "      <td>120.05722,31.97957</td>\n",
       "      <td>80</td>\n",
       "      <td>120.765243,32.241349</td>\n",
       "      <td>19813,82556</td>\n",
       "      <td>19813.0</td>\n",
       "      <td>82556.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>308</th>\n",
       "      <td>5</td>\n",
       "      <td>120.05374,31.9833</td>\n",
       "      <td>80</td>\n",
       "      <td>120.765243,32.241349</td>\n",
       "      <td>19843,82681</td>\n",
       "      <td>19843.0</td>\n",
       "      <td>82681.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1362855</th>\n",
       "      <td>11168</td>\n",
       "      <td>121.51557,32.02781</td>\n",
       "      <td>79</td>\n",
       "      <td>120.51244,32.137315</td>\n",
       "      <td>25175,104898</td>\n",
       "      <td>25175.0</td>\n",
       "      <td>104898.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1362856</th>\n",
       "      <td>11169</td>\n",
       "      <td>121.51746,32.03974</td>\n",
       "      <td>79</td>\n",
       "      <td>120.51244,32.137315</td>\n",
       "      <td>25274,105311</td>\n",
       "      <td>25274.0</td>\n",
       "      <td>105311.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1362857</th>\n",
       "      <td>11170</td>\n",
       "      <td>121.50454,32.04188</td>\n",
       "      <td>79</td>\n",
       "      <td>120.51244,32.137315</td>\n",
       "      <td>25060,104418</td>\n",
       "      <td>25060.0</td>\n",
       "      <td>104418.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1362858</th>\n",
       "      <td>11171</td>\n",
       "      <td>121.50935,32.04287</td>\n",
       "      <td>79</td>\n",
       "      <td>120.51244,32.137315</td>\n",
       "      <td>25175,104898</td>\n",
       "      <td>25175.0</td>\n",
       "      <td>104898.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1362859</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>79</td>\n",
       "      <td>120.51244,32.137315</td>\n",
       "      <td>24972,104052</td>\n",
       "      <td>24972.0</td>\n",
       "      <td>104052.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>647975 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         居民点id         居民点location  设施点id           设施点location  \\\n",
       "48           1  120.15568,31.97798     80  120.765243,32.241349   \n",
       "113          2  120.05855,31.98966     80  120.765243,32.241349   \n",
       "178          3  120.04138,31.99845     80  120.765243,32.241349   \n",
       "243          4  120.05722,31.97957     80  120.765243,32.241349   \n",
       "308          5   120.05374,31.9833     80  120.765243,32.241349   \n",
       "...        ...                 ...    ...                   ...   \n",
       "1362855  11168  121.51557,32.02781     79   120.51244,32.137315   \n",
       "1362856  11169  121.51746,32.03974     79   120.51244,32.137315   \n",
       "1362857  11170  121.50454,32.04188     79   120.51244,32.137315   \n",
       "1362858  11171  121.50935,32.04287     79   120.51244,32.137315   \n",
       "1362859  11172  121.51107,32.05536     79   120.51244,32.137315   \n",
       "\n",
       "        duration_distance_bicycling  duration  distance  \n",
       "48                      17540,73083   17540.0   73083.0  \n",
       "113                     19770,82376   19770.0   82376.0  \n",
       "178                     20093,83720   20093.0   83720.0  \n",
       "243                     19813,82556   19813.0   82556.0  \n",
       "308                     19843,82681   19843.0   82681.0  \n",
       "...                             ...       ...       ...  \n",
       "1362855                25175,104898   25175.0  104898.0  \n",
       "1362856                25274,105311   25274.0  105311.0  \n",
       "1362857                25060,104418   25060.0  104418.0  \n",
       "1362858                25175,104898   25175.0  104898.0  \n",
       "1362859                24972,104052   24972.0  104052.0  \n",
       "\n",
       "[647975 rows x 7 columns]"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res_66_123 = result[(result['设施点id']>=66) & (result['设施点id']<=123)]\n",
    "res_66_123"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "58"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "res_66_123['设施点id'].nunique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [],
   "source": [
    "res_66_123.set_index('居民点id').to_excel('./bicycling/骑行OD矩阵66-123.xlsx')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>居民点id</th>\n",
       "      <th>居民点location</th>\n",
       "      <th>设施点id</th>\n",
       "      <th>设施点location</th>\n",
       "      <th>duration_distance_bicycling</th>\n",
       "      <th>duration</th>\n",
       "      <th>distance</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1206889</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>110</td>\n",
       "      <td>120.2273342,31.98330751</td>\n",
       "      <td>1897,7903</td>\n",
       "      <td>1897.0</td>\n",
       "      <td>7903.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206944</th>\n",
       "      <td>2</td>\n",
       "      <td>120.05855,31.98966</td>\n",
       "      <td>109</td>\n",
       "      <td>120.092621,31.99860122</td>\n",
       "      <td>1103,4594</td>\n",
       "      <td>1103.0</td>\n",
       "      <td>4594.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1207000</th>\n",
       "      <td>3</td>\n",
       "      <td>120.04138,31.99845</td>\n",
       "      <td>109</td>\n",
       "      <td>120.092621,31.99860122</td>\n",
       "      <td>1308,5450</td>\n",
       "      <td>1308.0</td>\n",
       "      <td>5450.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1207056</th>\n",
       "      <td>4</td>\n",
       "      <td>120.05722,31.97957</td>\n",
       "      <td>109</td>\n",
       "      <td>120.092621,31.99860122</td>\n",
       "      <td>1371,5711</td>\n",
       "      <td>1371.0</td>\n",
       "      <td>5711.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1207112</th>\n",
       "      <td>5</td>\n",
       "      <td>120.05374,31.9833</td>\n",
       "      <td>109</td>\n",
       "      <td>120.092621,31.99860122</td>\n",
       "      <td>1354,5642</td>\n",
       "      <td>1354.0</td>\n",
       "      <td>5642.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206571</th>\n",
       "      <td>11168</td>\n",
       "      <td>121.51557,32.02781</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>1255,5228</td>\n",
       "      <td>1255.0</td>\n",
       "      <td>5228.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206627</th>\n",
       "      <td>11169</td>\n",
       "      <td>121.51746,32.03974</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>1160,4835</td>\n",
       "      <td>1160.0</td>\n",
       "      <td>4835.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206683</th>\n",
       "      <td>11170</td>\n",
       "      <td>121.50454,32.04188</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>946,3942</td>\n",
       "      <td>946.0</td>\n",
       "      <td>3942.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206739</th>\n",
       "      <td>11171</td>\n",
       "      <td>121.50935,32.04287</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>1061,4422</td>\n",
       "      <td>1061.0</td>\n",
       "      <td>4422.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206795</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>752,3133</td>\n",
       "      <td>752.0</td>\n",
       "      <td>3133.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>11172 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         居民点id         居民点location  设施点id              设施点location  \\\n",
       "1206889      1  120.15568,31.97798    110  120.2273342,31.98330751   \n",
       "1206944      2  120.05855,31.98966    109   120.092621,31.99860122   \n",
       "1207000      3  120.04138,31.99845    109   120.092621,31.99860122   \n",
       "1207056      4  120.05722,31.97957    109   120.092621,31.99860122   \n",
       "1207112      5   120.05374,31.9833    109   120.092621,31.99860122   \n",
       "...        ...                 ...    ...                      ...   \n",
       "1206571  11168  121.51557,32.02781     70  121.4841706,32.05601369   \n",
       "1206627  11169  121.51746,32.03974     70  121.4841706,32.05601369   \n",
       "1206683  11170  121.50454,32.04188     70  121.4841706,32.05601369   \n",
       "1206739  11171  121.50935,32.04287     70  121.4841706,32.05601369   \n",
       "1206795  11172  121.51107,32.05536     70  121.4841706,32.05601369   \n",
       "\n",
       "        duration_distance_bicycling  duration  distance  \n",
       "1206889                   1897,7903    1897.0    7903.0  \n",
       "1206944                   1103,4594    1103.0    4594.0  \n",
       "1207000                   1308,5450    1308.0    5450.0  \n",
       "1207056                   1371,5711    1371.0    5711.0  \n",
       "1207112                   1354,5642    1354.0    5642.0  \n",
       "...                             ...       ...       ...  \n",
       "1206571                   1255,5228    1255.0    5228.0  \n",
       "1206627                   1160,4835    1160.0    4835.0  \n",
       "1206683                    946,3942     946.0    3942.0  \n",
       "1206739                   1061,4422    1061.0    4422.0  \n",
       "1206795                    752,3133     752.0    3133.0  \n",
       "\n",
       "[11172 rows x 7 columns]"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 最小时间\n",
    "min_time2 = res_66_123.sort_values(by='duration')\\\n",
    "            .groupby(by='居民点id')\\\n",
    "            .head(1)\\\n",
    "            .sort_values(by='居民点id')\n",
    "min_time2[['居民点id','居民点location','设施点id','设施点location','duration']].set_index('居民点id').to_excel('./bicycling/骑行OD矩阵最小时间66-123.xlsx')\n",
    "min_time2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>居民点id</th>\n",
       "      <th>居民点location</th>\n",
       "      <th>设施点id</th>\n",
       "      <th>设施点location</th>\n",
       "      <th>duration_distance_bicycling</th>\n",
       "      <th>duration</th>\n",
       "      <th>distance</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1206889</th>\n",
       "      <td>1</td>\n",
       "      <td>120.15568,31.97798</td>\n",
       "      <td>110</td>\n",
       "      <td>120.2273342,31.98330751</td>\n",
       "      <td>1897,7903</td>\n",
       "      <td>1897.0</td>\n",
       "      <td>7903.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206944</th>\n",
       "      <td>2</td>\n",
       "      <td>120.05855,31.98966</td>\n",
       "      <td>109</td>\n",
       "      <td>120.092621,31.99860122</td>\n",
       "      <td>1103,4594</td>\n",
       "      <td>1103.0</td>\n",
       "      <td>4594.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1207000</th>\n",
       "      <td>3</td>\n",
       "      <td>120.04138,31.99845</td>\n",
       "      <td>109</td>\n",
       "      <td>120.092621,31.99860122</td>\n",
       "      <td>1308,5450</td>\n",
       "      <td>1308.0</td>\n",
       "      <td>5450.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1207056</th>\n",
       "      <td>4</td>\n",
       "      <td>120.05722,31.97957</td>\n",
       "      <td>109</td>\n",
       "      <td>120.092621,31.99860122</td>\n",
       "      <td>1371,5711</td>\n",
       "      <td>1371.0</td>\n",
       "      <td>5711.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1207112</th>\n",
       "      <td>5</td>\n",
       "      <td>120.05374,31.9833</td>\n",
       "      <td>109</td>\n",
       "      <td>120.092621,31.99860122</td>\n",
       "      <td>1354,5642</td>\n",
       "      <td>1354.0</td>\n",
       "      <td>5642.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206571</th>\n",
       "      <td>11168</td>\n",
       "      <td>121.51557,32.02781</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>1255,5228</td>\n",
       "      <td>1255.0</td>\n",
       "      <td>5228.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206627</th>\n",
       "      <td>11169</td>\n",
       "      <td>121.51746,32.03974</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>1160,4835</td>\n",
       "      <td>1160.0</td>\n",
       "      <td>4835.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206683</th>\n",
       "      <td>11170</td>\n",
       "      <td>121.50454,32.04188</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>946,3942</td>\n",
       "      <td>946.0</td>\n",
       "      <td>3942.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206739</th>\n",
       "      <td>11171</td>\n",
       "      <td>121.50935,32.04287</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>1061,4422</td>\n",
       "      <td>1061.0</td>\n",
       "      <td>4422.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1206795</th>\n",
       "      <td>11172</td>\n",
       "      <td>121.51107,32.05536</td>\n",
       "      <td>70</td>\n",
       "      <td>121.4841706,32.05601369</td>\n",
       "      <td>752,3133</td>\n",
       "      <td>752.0</td>\n",
       "      <td>3133.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>11172 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         居民点id         居民点location  设施点id              设施点location  \\\n",
       "1206889      1  120.15568,31.97798    110  120.2273342,31.98330751   \n",
       "1206944      2  120.05855,31.98966    109   120.092621,31.99860122   \n",
       "1207000      3  120.04138,31.99845    109   120.092621,31.99860122   \n",
       "1207056      4  120.05722,31.97957    109   120.092621,31.99860122   \n",
       "1207112      5   120.05374,31.9833    109   120.092621,31.99860122   \n",
       "...        ...                 ...    ...                      ...   \n",
       "1206571  11168  121.51557,32.02781     70  121.4841706,32.05601369   \n",
       "1206627  11169  121.51746,32.03974     70  121.4841706,32.05601369   \n",
       "1206683  11170  121.50454,32.04188     70  121.4841706,32.05601369   \n",
       "1206739  11171  121.50935,32.04287     70  121.4841706,32.05601369   \n",
       "1206795  11172  121.51107,32.05536     70  121.4841706,32.05601369   \n",
       "\n",
       "        duration_distance_bicycling  duration  distance  \n",
       "1206889                   1897,7903    1897.0    7903.0  \n",
       "1206944                   1103,4594    1103.0    4594.0  \n",
       "1207000                   1308,5450    1308.0    5450.0  \n",
       "1207056                   1371,5711    1371.0    5711.0  \n",
       "1207112                   1354,5642    1354.0    5642.0  \n",
       "...                             ...       ...       ...  \n",
       "1206571                   1255,5228    1255.0    5228.0  \n",
       "1206627                   1160,4835    1160.0    4835.0  \n",
       "1206683                    946,3942     946.0    3942.0  \n",
       "1206739                   1061,4422    1061.0    4422.0  \n",
       "1206795                    752,3133     752.0    3133.0  \n",
       "\n",
       "[11172 rows x 7 columns]"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 最小距离\n",
    "min_distance2 = res_66_123.sort_values(by='distance')\\\n",
    "            .groupby(by='居民点id')\\\n",
    "            .head(1)\\\n",
    "            .sort_values(by='居民点id')\n",
    "min_distance2[['居民点id','居民点location','设施点id','设施点location','distance']].set_index('居民点id').to_excel('./bicycling/骑行OD矩阵最小距离66-123.xlsx')\n",
    "min_distance2"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
